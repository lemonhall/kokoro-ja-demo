# G2P æ¨¡å—å®ç°çŠ¶æ€

## âœ… å·²å®ŒæˆåŠŸèƒ½

### 1. è‹±æ–‡ G2Pï¼ˆåŸºäº CMUdictï¼‰

**æ ¸å¿ƒå‡½æ•°**ï¼š
- âœ… `misaki_en_g2p_word()` - å•è¯æŸ¥è¯¢
- âœ… `misaki_en_g2p()` - å¥å­è½¬æ¢
- âœ… `misaki_en_g2p_oov()` - æœªç™»å½•è¯å¤„ç†ï¼ˆç®€åŒ–ç‰ˆï¼‰

**ç¤ºä¾‹**ï¼š
```
è¾“å…¥ï¼š"Hello world"
è¾“å‡ºï¼š
  [0] "Hello" â†’ hÉ™lËˆO
  [1] "world" â†’ wËˆÉœÉ¹ld
```

**æ•°æ®æ¥æº**ï¼š`extracted_data/en/us_dict.txt`ï¼ˆ183,561 ä¸ªå•è¯ï¼‰

---

### 2. ä¸­æ–‡ G2Pï¼ˆæ±‰å­— â†’ æ‹¼éŸ³ï¼‰

**æ ¸å¿ƒå‡½æ•°**ï¼š
- âœ… `misaki_zh_g2p()` - å®Œæ•´æµç¨‹ï¼ˆåˆ†è¯ + æ‹¼éŸ³æŸ¥è¯¢ï¼‰
- âœ… `misaki_zh_pinyin_to_ipa()` - æ‹¼éŸ³è½¬ IPAï¼ˆç®€åŒ–ç‰ˆï¼‰
- â³ `misaki_zh_tone_sandhi()` - å£°è°ƒå˜åŒ–ï¼ˆTODOï¼‰
- â³ `misaki_zh_erhua()` - å„¿åŒ–éŸ³ï¼ˆTODOï¼‰

**ç¤ºä¾‹**ï¼š
```
è¾“å…¥ï¼š"ä½ å¥½ä¸–ç•Œ"
è¾“å‡ºï¼š
  [0] "ä½ " â†’ nÇ
  [1] "å¥½" â†’ hÇo
  [2] "ä¸–ç•Œ" â†’ shÃ¬ jiÃ¨
  
åˆå¹¶éŸ³ç´ : "nÇ hÇo shÃ¬ jiÃ¨"
```

**æ•°æ®æ¥æº**ï¼š
- å•å­—æ‹¼éŸ³ï¼š`extracted_data/zh/pinyin_dict.txt`ï¼ˆ41,924 ä¸ªæ±‰å­—ï¼‰
- è¯æ±‡è¯å…¸ï¼š`extracted_data/zh/dict.txt`ï¼ˆ86 ä¸ªè¯æ±‡ï¼‰

**æ³¨æ„äº‹é¡¹**ï¼š
- å¤šéŸ³å­—é€‰æ‹©ï¼šå½“å‰ä½¿ç”¨ç¬¬ä¸€ä¸ªæ‹¼éŸ³ï¼ˆç®€åŒ–å¤„ç†ï¼‰
- å®Œæ•´ç‰ˆéœ€è¦æ ¹æ®ä¸Šä¸‹æ–‡é€‰æ‹©æ­£ç¡®æ‹¼éŸ³

---

### 3. æ—¥æ–‡ G2Pï¼ˆå‡å â†’ éŸ³ç´ ï¼‰

**æ ¸å¿ƒå‡½æ•°**ï¼š
- âœ… `misaki_ja_g2p()` - å®Œæ•´æµç¨‹ï¼ˆåˆ†è¯ + éŸ³ç´ è½¬æ¢ï¼‰
- âœ… `misaki_ja_kana_to_ipa()` - å‡åè½¬ IPAï¼ˆç®€åŒ–ç‰ˆï¼‰
- â³ `misaki_ja_long_vowel()` - é•¿éŸ³å¤„ç†ï¼ˆTODOï¼‰

**ç¤ºä¾‹**ï¼š
```
è¾“å…¥ï¼š"ã“ã‚“ã«ã¡ã¯ä¸–ç•Œ"
è¾“å‡ºï¼š
  [0] "ã“ã‚“ã«ã¡ã¯" â†’ ã“ã‚“ã«ã¡ã¯ï¼ˆå¾…å®Œå–„ï¼‰
  [1] "ä¸–ç•Œ" â†’ ä¸–ç•Œï¼ˆå¾…å®Œå–„ï¼‰
```

**å¾…å®Œå–„**ï¼š
- å‡å â†’ ç½—é©¬éŸ³ â†’ IPA æ˜ å°„
- å¯å‚è€ƒ OpenJTalk çš„ `jpcommon_rule_utf_8.h` è§„åˆ™

---

### 4. å·¥å…·å‡½æ•°

**å·²å®ç°**ï¼š
- âœ… `misaki_merge_phonemes()` - åˆå¹¶éŸ³ç´ åºåˆ—
- âœ… `misaki_count_phonemes()` - ç»Ÿè®¡éŸ³ç´ æ•°é‡
- âœ… `misaki_g2p_print()` - æ‰“å° G2P ç»“æœ
- âœ… `misaki_g2p_stats()` - ç»Ÿè®¡ä¿¡æ¯ï¼ˆæ€»éŸ³ç´ ã€OOV æ•°é‡ï¼‰
- âœ… `misaki_g2p_default_options()` - é»˜è®¤é…ç½®

**å¾…å®ç°**ï¼š
- â³ `misaki_normalize_text()` - æ–‡æœ¬è§„èŒƒåŒ–
- â³ `misaki_zh_num_to_text()` - ä¸­æ–‡æ•°å­—è½¬æ–‡å­—
- â³ `misaki_en_num_to_text()` - è‹±æ–‡æ•°å­—è½¬æ–‡å­—
- â³ `misaki_fullwidth_to_halfwidth()` - å…¨è§’è½¬åŠè§’
- â³ `misaki_traditional_to_simplified()` - ç¹ä½“è½¬ç®€ä½“

---

## ğŸ“Š æµ‹è¯•è¦†ç›–ç‡

| æ¨¡å— | æµ‹è¯•æ•°é‡ | é€šè¿‡ç‡ | æ–‡ä»¶ |
|------|---------|--------|------|
| è‹±æ–‡ G2P | 2 | 100% | `tests/test_g2p.c` |
| ä¸­æ–‡ G2P | 1 | 100% | `tests/test_g2p.c` |
| æ—¥æ–‡ G2P | 1 | 100% | `tests/test_g2p.c` |
| å·¥å…·å‡½æ•° | 2 | 100% | `tests/test_g2p.c` |
| **æ€»è®¡** | **6** | **100%** | - |

---

## ğŸš€ ä¸‹ä¸€æ­¥ä¼˜åŒ–

### é«˜ä¼˜å…ˆçº§

1. **ä¸­æ–‡æ‹¼éŸ³ â†’ IPA è½¬æ¢**
   ```c
   // å½“å‰ï¼šnÇ hÇo
   // ç›®æ ‡ï¼šniâ†“ xÉ‘ÊŠâ†“ (å®Œæ•´ IPA)
   ```

2. **æ—¥æ–‡å‡å â†’ IPA è½¬æ¢**
   ```c
   // å½“å‰ï¼šã“ã‚“ã«ã¡ã¯
   // ç›®æ ‡ï¼škonnitÍ¡É•iwa (åŸºäº OpenJTalk è§„åˆ™)
   ```

3. **å¤šéŸ³å­—ä¸Šä¸‹æ–‡é€‰æ‹©**
   ```c
   // ç¤ºä¾‹ï¼š"é•¿åŸ"
   // æ­£ç¡®ï¼šchÃ¡ng chÃ©ng (è€Œä¸æ˜¯ zhÇng chÃ©ng)
   ```

### ä¸­ä¼˜å…ˆçº§

4. **ä¸­æ–‡å£°è°ƒå˜åŒ–**
   - ä¸‰å£°å˜è°ƒï¼šnÇ hÇo â†’ nÃ­ hÇo
   - ä¸€ä¸å˜è°ƒï¼šä¸€ä¸ª â†’ yÃ­ ge
   - è½»å£°å¤„ç†ï¼šä»–ä»¬ â†’ tÄ men5

5. **å„¿åŒ–éŸ³å¤„ç†**
   - ç©å„¿ â†’ wÃ¡nr (è€Œä¸æ˜¯ wÃ¡n Ã©r)
   - ä¸€ç‚¹å„¿ â†’ yÃ¬diÇnr

6. **è‹±æ–‡æœªç™»å½•è¯**
   - åŸºäºè§„åˆ™çš„éŸ³ç´ é¢„æµ‹ï¼ˆå¦‚ Sequitur G2Pï¼‰

### ä½ä¼˜å…ˆçº§

7. **æ–‡æœ¬è§„èŒƒåŒ–**
   - å…¨è§’è½¬åŠè§’
   - ç¹ä½“è½¬ç®€ä½“
   - æ•°å­—è½¬æ–‡å­—

8. **éŸ©æ–‡/è¶Šå—æ–‡æ”¯æŒ**

---

## ğŸ“ ç›¸å…³æ–‡ä»¶

### æ ¸å¿ƒå®ç°
- `src/core/misaki_g2p.c` (560 è¡Œ) - G2P å®ç°
- `include/misaki_g2p.h` (418 è¡Œ) - G2P æ¥å£

### æµ‹è¯•
- `tests/test_g2p.c` (299 è¡Œ) - 6 ä¸ªæµ‹è¯•ç”¨ä¾‹

### æ•°æ®
- `extracted_data/en/us_dict.txt` - è‹±æ–‡è¯å…¸ï¼ˆ183,561 è¯ï¼‰
- `extracted_data/zh/pinyin_dict.txt` - ä¸­æ–‡æ‹¼éŸ³ï¼ˆ41,924 å­—ï¼‰
- `extracted_data/zh/dict.txt` - ä¸­æ–‡è¯æ±‡ï¼ˆ86 è¯ï¼‰

---

## ğŸ¯ å®Œæ•´æµç¨‹ç¤ºä¾‹

### è‹±æ–‡ TTS æµç¨‹
```
æ–‡æœ¬è¾“å…¥ï¼š"Hello world"
    â†“
åˆ†è¯ï¼š["Hello", "world"]
    â†“
G2Pï¼š["hÉ™lËˆO", "wËˆÉœÉ¹ld"]
    â†“
TTS æ¨¡å‹ â†’ è¯­éŸ³è¾“å‡º
```

### ä¸­æ–‡ TTS æµç¨‹
```
æ–‡æœ¬è¾“å…¥ï¼š"ä½ å¥½ä¸–ç•Œ"
    â†“
åˆ†è¯ï¼š["ä½ ", "å¥½", "ä¸–ç•Œ"]
    â†“
æ‹¼éŸ³ï¼š["nÇ", "hÇo", "shÃ¬ jiÃ¨"]
    â†“
IPAï¼š["niâ†“", "xÉ‘ÊŠâ†“", "Ê‚Ê…â†“ tÉ•iÉ›â†“"] (å¾…å®ç°)
    â†“
TTS æ¨¡å‹ â†’ è¯­éŸ³è¾“å‡º
```

### æ—¥æ–‡ TTS æµç¨‹
```
æ–‡æœ¬è¾“å…¥ï¼š"ã“ã‚“ã«ã¡ã¯ä¸–ç•Œ"
    â†“
åˆ†è¯ï¼š["ã“ã‚“ã«ã¡ã¯", "ä¸–ç•Œ"]
    â†“
éŸ³ç´ ï¼š["konnitÍ¡É•iwa", "sekai"] (å¾…å®ç°)
    â†“
TTS æ¨¡å‹ â†’ è¯­éŸ³è¾“å‡º
```

---

## ğŸ“š å‚è€ƒèµ„æº

### æ‹¼éŸ³ â†’ IPA æ˜ å°„
- [æ±‰è¯­æ‹¼éŸ³ IPA å¯¹ç…§è¡¨](https://en.wikipedia.org/wiki/Help:IPA/Mandarin)
- pypinyin åº“çš„å®ç°

### æ—¥æ–‡å‡å â†’ éŸ³ç´ 
- OpenJTalk è§„åˆ™æ–‡ä»¶ï¼š`open_jtalk-1.11/mecab-naist-jdic/jpcommon_rule_utf_8.h`
- [æ—¥æœ¬èª IPA å¯¹ç…§è¡¨](https://en.wikipedia.org/wiki/Help:IPA/Japanese)

### å£°è°ƒå˜åŒ–
- ã€Šç°ä»£æ±‰è¯­è¯å…¸ã€‹å£°è°ƒå˜åŒ–è§„åˆ™
- [ä¸‰å£°å˜è°ƒè§„åˆ™](https://resources.allsetlearning.com/chinese/grammar/Tone_change_rules)

---

**æ›´æ–°æ—¶é—´**ï¼š2025-10-25  
**çŠ¶æ€**ï¼šG2P åŸºç¡€æ¡†æ¶å®Œæˆï¼Œæ ¸å¿ƒåŠŸèƒ½å¾…å®Œå–„
